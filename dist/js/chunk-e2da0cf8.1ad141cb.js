(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e2da0cf8"],{1276:function(t,i,a){"use strict";var e=a("d784"),n=a("44e7"),s=a("825a"),o=a("1d80"),r=a("4840"),c=a("8aa5"),l=a("50c4"),u=a("14c3"),d=a("9263"),p=a("d039"),h=[].push,g=Math.min,f=4294967295,v=!p((function(){return!RegExp(f,"y")}));e("split",2,(function(t,i,a){var e;return e="c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length?function(t,a){var e=String(o(this)),s=void 0===a?f:a>>>0;if(0===s)return[];if(void 0===t)return[e];if(!n(t))return i.call(e,t,s);var r,c,l,u=[],p=(t.ignoreCase?"i":"")+(t.multiline?"m":"")+(t.unicode?"u":"")+(t.sticky?"y":""),g=0,v=new RegExp(t.source,p+"g");while(r=d.call(v,e)){if(c=v.lastIndex,c>g&&(u.push(e.slice(g,r.index)),r.length>1&&r.index<e.length&&h.apply(u,r.slice(1)),l=r[0].length,g=c,u.length>=s))break;v.lastIndex===r.index&&v.lastIndex++}return g===e.length?!l&&v.test("")||u.push(""):u.push(e.slice(g)),u.length>s?u.slice(0,s):u}:"0".split(void 0,0).length?function(t,a){return void 0===t&&0===a?[]:i.call(this,t,a)}:i,[function(i,a){var n=o(this),s=void 0==i?void 0:i[t];return void 0!==s?s.call(i,n,a):e.call(String(n),i,a)},function(t,n){var o=a(e,t,this,n,e!==i);if(o.done)return o.value;var d=s(t),p=String(this),h=r(d,RegExp),b=d.unicode,m=(d.ignoreCase?"i":"")+(d.multiline?"m":"")+(d.unicode?"u":"")+(v?"y":"g"),k=new h(v?d:"^(?:"+d.source+")",m),x=void 0===n?f:n>>>0;if(0===x)return[];if(0===p.length)return null===u(k,p)?[p]:[];var C=0,_=0,$=[];while(_<p.length){k.lastIndex=v?_:0;var y,S=u(k,v?p:p.slice(_));if(null===S||(y=g(l(k.lastIndex+(v?0:_)),p.length))===C)_=c(p,_,b);else{if($.push(p.slice(C,_)),$.length===x)return $;for(var D=1;D<=S.length-1;D++)if($.push(S[D]),$.length===x)return $;_=C=y}}return $.push(p.slice(C)),$}]}),!v)},a15b:function(t,i,a){"use strict";var e=a("23e7"),n=a("44ad"),s=a("fc6a"),o=a("a640"),r=[].join,c=n!=Object,l=o("join",",");e({target:"Array",proto:!0,forced:c||!l},{join:function(t){return r.call(s(this),void 0===t?",":t)}})},a640:function(t,i,a){"use strict";var e=a("d039");t.exports=function(t,i){var a=[][t];return!!a&&e((function(){a.call(null,i||function(){throw 1},1)}))}},c84b:function(t,i,a){"use strict";a.r(i);var e=function(){var t=this,i=t.$createElement,a=t._self._c||i;return a("div",{staticClass:"detail"},[a("van-nav-bar",{attrs:{title:"商品详情","left-text":"返回","left-arrow":"",fixed:""},on:{"click-left":t.back}}),a("div",[a("div",[a("img",{staticClass:"auto-img",attrs:{src:t.productDetail.large_img,alt:""}})]),a("div",{staticClass:"pro-info-box"},[a("div",{staticClass:"pro-info"},[a("div",{staticClass:"clearfix pro-box"},[a("div",{staticClass:"fl"},[a("div",{staticClass:"pro-name"},[t._v(t._s(t.productDetail.name))]),a("div",{staticClass:"pro-enname"},[t._v(t._s(t.productDetail.enname))])]),a("div",{staticClass:"fr pro-price"},[t._v("￥"+t._s(t.productDetail.price))])]),a("div",[a("div",{staticClass:"rule-box"},t._l(t.productDetail.rules,(function(i,e){return a("div",{key:e,staticClass:"rule-items clearfix"},[a("div",{staticClass:"fl rule-title"},[t._v(t._s(i.title))]),a("div",{staticClass:"fl"},t._l(i.rule,(function(e,n){return a("div",{key:n,staticClass:"fl r-item",class:{active:i.ruleIndex==n,"large-text":e.title.length>=4},on:{click:function(a){return t.toggleRule(i,n)}}},[t._v(t._s(e.title))])})),0)])})),0),a("div",{staticClass:"clearfix c-box"},[a("div",{staticClass:"fl select-count"},[t._v("选择数量")]),a("div",{staticClass:"fr count-box"},[a("van-stepper",{attrs:{theme:"round","button-size":"22","disable-input":""},model:{value:t.product.count,callback:function(i){t.$set(t.product,"count",i)},expression:"product.count"}})],1)]),a("div",{staticClass:"desc-box"},[a("div",{staticClass:"pro-desc"},[t._v("商品描述")]),a("div",{staticClass:"desc-text"},t._l(t.productDetail.desc,(function(i,e){return a("div",{key:e,staticClass:"text-item"},[t._v(t._s(e+1)+"、"+t._s(i))])})),0)])])])])]),a("van-goods-action",[a("van-goods-action-icon",{attrs:{to:{name:"Shopbag"},icon:"bag",text:"购物袋",badge:0==t.bagCount?"":t.bagCount,color:t.bagCount>0?"#d9baba":"#646566"}}),a("van-goods-action-icon",{attrs:{icon:"like",text:t.isLike?"已收藏":"未收藏",color:t.isLike?"#d9baba":"#646566"},on:{click:t.toggleLikeProduct}}),a("van-goods-action-button",{attrs:{text:"加入购物袋",color:"#d9DDb0"},on:{click:function(i){return t.addShopbag()}}}),a("van-goods-action-button",{attrs:{text:"立即购买",color:"#d9baba"},on:{click:function(i){return t.buy(!0)}}})],1)],1)},n=[],s=(a("a15b"),a("d81d"),a("ac1f"),a("1276"),a("eadb"),{name:"Detail",data:function(){return{pid:"",product:{count:1},bagCount:0,productDetail:{},isLike:!1}},created:function(){this.pid=this.$route.params.pid,this.getProductDetail(),this.findLike(),this.shopBagCount()},methods:{getProductDetail:function(){var t=this;this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/productDetail",params:{appkey:this.appkey,pid:this.pid}}).then((function(i){if(t.$toast.clear(),600==i.data.code){var a=i.data.result[0];a.desc=a.desc.split(/\n/);var e=[],n=["tem","sugar","milk","cream"];n.map((function(t){var i={};i.title=a[t+"_desc"],i.ruleIndex=0,i.rule=[];var n=a[t].split("/");n.map((function(t){""!=t&&i.rule.push({title:t})})),i.rule.length>0&&e.push(i)})),a.rules=e,t.productDetail=a}})).catch((function(i){t.$toast.clear()}))},back:function(){this.$router.go(-1)},toggleRule:function(t,i){t.ruleIndex!=i&&(t.ruleIndex=i)},findLike:function(){var t=this,i=localStorage.getItem("__tk");i&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/findlike",params:{appkey:this.appkey,pid:this.pid,tokenString:i}}).then((function(i){t.$toast.clear(),1e3==i.data.code&&i.data.result.length>0&&(t.isLike=!0)})).catch((function(i){t.$toast.clear()})))},toggleLikeProduct:function(){var t=this,i=localStorage.getItem("__tk");if(!i)return this.$toast("请先登录"),this.$router.push({name:"Login"});var a=this.isLike?"/notlike":"/like";this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:a,data:{appkey:this.appkey,pid:this.pid,tokenString:i}}).then((function(i){t.$toast.clear(),700==i.data.code?t.$router.push({name:"Login"}):800==i.data.code?t.isLike=!0:900==i.data.code&&(t.isLike=!1),t.$toast(i.data.msg)})).catch((function(i){t.$toast.clear()}))},shopBagCount:function(){var t=this,i=localStorage.getItem("__tk");i&&(this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"GET",url:"/shopcartRows",params:{appkey:this.appkey,tokenString:i}}).then((function(i){t.$toast.clear(),8e3==i.data.code&&(t.bagCount=i.data.result)})).catch((function(i){t.$toast.clear()})))},addShopbag:function(t){var i=this,a=localStorage.getItem("__tk");if(!a)return this.$toast("请先登录"),this.$router.push({name:"Login"});var e={tokenString:a,appkey:this.appkey,count:this.product.count,pid:this.pid},n=[];this.productDetail.rules.map((function(t){n.push(t.rule[t.ruleIndex].title)})),e.rule=n.join("/"),this.$toast.loading({message:"加载中...",forbidClick:!0,duration:0}),this.axios({method:"POST",url:"/addShopcart",data:e}).then((function(a){i.$toast.clear(),700==a.data.code?i.$router.push({name:"Login"}):3e3==a.data.code&&(t?i.$router.push({name:"Pay",query:{sids:a.data.sid}}):1==a.data.status&&i.bagCount++),i.$toast(a.data.msg)})).catch((function(t){i.$toast.clear()}))},buy:function(t){this.addShopbag(t)}}}),o=s,r=a("2877"),c=Object(r["a"])(o,e,n,!1,null,null,null);i["default"]=c.exports},d81d:function(t,i,a){"use strict";var e=a("23e7"),n=a("b727").map,s=a("1dde"),o=a("ae40"),r=s("map"),c=o("map");e({target:"Array",proto:!0,forced:!r||!c},{map:function(t){return n(this,t,arguments.length>1?arguments[1]:void 0)}})},eadb:function(t,i,a){}}]);
//# sourceMappingURL=chunk-e2da0cf8.1ad141cb.js.map